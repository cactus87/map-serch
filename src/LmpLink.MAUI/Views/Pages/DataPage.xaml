<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:LmpLink.MAUI.ViewModels"
             x:Class="LmpLink.MAUI.Views.Pages.DataPage"
             x:DataType="vm:DataViewModel"
             Title="ë°ì´í„°"
             BackgroundColor="{StaticResource BackgroundDeepNavy}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Title -->
            <Label 
                Text="ðŸ“¥ ë°ì´í„° ê´€ë¦¬"
                Style="{StaticResource Heading1}"
                TextColor="{StaticResource PrimaryCTA}" />

            <!-- Excel Export -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="10">
                    <Label 
                        Text="ðŸ“¤ ì—‘ì…€ ë‚´ë³´ë‚´ê¸°"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    <Label 
                        Text="í˜„ìž¬ ë°ì´í„°ë¥¼ ì—‘ì…€ íŒŒì¼ë¡œ ì €ìž¥í•©ë‹ˆë‹¤."
                        Style="{StaticResource Body2}"
                        TextColor="{StaticResource TextLightGray}" />
                    <Button 
                        Text="ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°"
                        Command="{Binding ExportToExcelCommand}"
                        BackgroundColor="{StaticResource AccentSecondary}"
                        TextColor="{StaticResource TextWhite}"
                        CornerRadius="8"
                        Padding="15,10" />
                    
                    <!-- Export Status -->
                    <Label 
                        Text="{Binding LastExportPath, StringFormat='ë§ˆì§€ë§‰ ë‚´ë³´ë‚´ê¸°: {0}'}"
                        Style="{StaticResource Caption}"
                        TextColor="{StaticResource TextLightGray}"
                        IsVisible="{Binding LastExportPath, Converter={StaticResource IsNotNullConverter}}"
                        Margin="0,10,0,0" />
                    <Label 
                        Text="{Binding ExportedCount, StringFormat='ë‚´ë³´ë‚¸ ë°ì´í„°: {0}ëª…'}"
                        Style="{StaticResource Caption}"
                        TextColor="{StaticResource PrimaryCTA}"
                        IsVisible="{Binding ExportedCount, Converter={StaticResource IsNotNullConverter}}" />
                </VerticalStackLayout>
            </Frame>

            <!-- Excel Import -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="10">
                    <Label 
                        Text="ðŸ“¥ ì—‘ì…€ ë¶ˆëŸ¬ì˜¤ê¸°"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    <Label 
                        Text="ì—‘ì…€ íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤."
                        Style="{StaticResource Body2}"
                        TextColor="{StaticResource TextLightGray}" />
                    <Button 
                        Text="ì—‘ì…€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°"
                        Command="{Binding ImportFromExcelCommand}"
                        BackgroundColor="{StaticResource AccentSecondary}"
                        TextColor="{StaticResource TextWhite}"
                        CornerRadius="8"
                        Padding="15,10" />
                    
                    <!-- Import Status -->
                    <Label 
                        Text="{Binding LastImportPath, StringFormat='ë§ˆì§€ë§‰ ë¶ˆëŸ¬ì˜¤ê¸°: {0}'}"
                        Style="{StaticResource Caption}"
                        TextColor="{StaticResource TextLightGray}"
                        IsVisible="{Binding LastImportPath, Converter={StaticResource IsNotNullConverter}}"
                        Margin="0,10,0,0" />
                    <Label 
                        Text="{Binding ImportedCount, StringFormat='ë¶ˆëŸ¬ì˜¨ ë°ì´í„°: {0}ëª…'}"
                        Style="{StaticResource Caption}"
                        TextColor="{StaticResource PrimaryCTA}"
                        IsVisible="{Binding ImportedCount, Converter={StaticResource IsNotNullConverter}}" />
                </VerticalStackLayout>
            </Frame>

            <!-- Backup Settings -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="10">
                    <Label 
                        Text="ðŸ”„ ë°±ì—… ì„¤ì •"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    <Label 
                        Text="ðŸš§ ê°œë°œ ì¤‘ - ìžë™ ë°±ì—… ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ìž…ë‹ˆë‹¤."
                        Style="{StaticResource Body2}"
                        TextColor="{StaticResource TextLightGray}" />
                </VerticalStackLayout>
            </Frame>

            <!-- Current Data Save -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="10">
                    <Label 
                        Text="ðŸ’¾ í˜„ìž¬ ë°ì´í„° ì €ìž¥"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    <Label 
                        Text="í˜„ìž¬ ë°ì´í„°ë¥¼ Supabaseì— ì €ìž¥í•©ë‹ˆë‹¤."
                        Style="{StaticResource Body2}"
                        TextColor="{StaticResource TextLightGray}" />
                    <Button 
                        Text="í˜„ìž¬ ë°ì´í„° ì €ìž¥"
                        Command="{Binding SaveCurrentDataCommand}"
                        BackgroundColor="{StaticResource PrimaryCTA}"
                        TextColor="{StaticResource TextWhite}"
                        CornerRadius="8"
                        Padding="15,10" />
                </VerticalStackLayout>
            </Frame>

            <!-- Loading Indicator -->
            <ActivityIndicator
                IsRunning="{Binding IsLoading}"
                IsVisible="{Binding IsLoading}"
                Color="{StaticResource PrimaryCTA}"
                WidthRequest="40"
                HeightRequest="40"
                HorizontalOptions="Center"
                Margin="20" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>

