<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:LmpLink.MAUI.ViewModels"
             x:Class="LmpLink.MAUI.Views.Pages.SettingsPage"
             x:DataType="vm:SettingsViewModel"
             Title="ì„¤ì •"
             BackgroundColor="{StaticResource BackgroundDeepNavy}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Title -->
            <Label 
                Text="âš™ï¸ ì„¤ì •"
                Style="{StaticResource Heading1}"
                TextColor="{StaticResource PrimaryCTA}" />

            <!-- Marker Settings -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="ðŸŽ¨ ë§ˆì»¤ ì„¤ì •"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    
                    <!-- User Marker Color -->
                    <Grid ColumnDefinitions="*,Auto">
                        <Label 
                            Grid.Column="0"
                            Text="ì´ìš©ìž ë§ˆì»¤ ìƒ‰ìƒ"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}"
                            VerticalOptions="Center" />
                        <Frame 
                            Grid.Column="1"
                            WidthRequest="80"
                            HeightRequest="40"
                            CornerRadius="8"
                            Padding="0"
                            HasShadow="False"
                            BorderColor="{StaticResource TextTertiary}"
                            BackgroundColor="{Binding UserMarkerColor}" />
                    </Grid>

                    <!-- Assistant Marker Color -->
                    <Grid ColumnDefinitions="*,Auto">
                        <Label 
                            Grid.Column="0"
                            Text="í™œë™ì§€ì›ì‚¬ ë§ˆì»¤ ìƒ‰ìƒ"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}"
                            VerticalOptions="Center" />
                        <Frame 
                            Grid.Column="1"
                            WidthRequest="80"
                            HeightRequest="40"
                            CornerRadius="8"
                            Padding="0"
                            HasShadow="False"
                            BorderColor="{StaticResource TextTertiary}"
                            BackgroundColor="{Binding AssistantMarkerColor}" />
                    </Grid>

                    <!-- Marker Size -->
                    <VerticalStackLayout Spacing="8">
                        <Label 
                            Text="ë§ˆì»¤ í¬ê¸°"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}" />
                        <HorizontalStackLayout Spacing="10">
                            <Button 
                                Text="Small"
                                Command="{Binding UpdateMarkerSizeCommand}"
                                CommandParameter="Small"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding MarkerSize}" Value="Small">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Medium"
                                Command="{Binding UpdateMarkerSizeCommand}"
                                CommandParameter="Medium"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding MarkerSize}" Value="Medium">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Large"
                                Command="{Binding UpdateMarkerSizeCommand}"
                                CommandParameter="Large"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding MarkerSize}" Value="Large">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Circle Settings -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="ðŸ”˜ ë°˜ê²½ ì› ì„¤ì •"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    
                    <!-- Circle Color -->
                    <Grid ColumnDefinitions="*,Auto">
                        <Label 
                            Grid.Column="0"
                            Text="ì› ìƒ‰ìƒ"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}"
                            VerticalOptions="Center" />
                        <Frame 
                            Grid.Column="1"
                            WidthRequest="80"
                            HeightRequest="40"
                            CornerRadius="8"
                            Padding="0"
                            HasShadow="False"
                            BorderColor="{StaticResource TextTertiary}"
                            BackgroundColor="{Binding CircleColor}" />
                    </Grid>

                    <!-- Circle Opacity -->
                    <VerticalStackLayout Spacing="8">
                        <Grid ColumnDefinitions="*,Auto">
                            <Label 
                                Grid.Column="0"
                                Text="íˆ¬ëª…ë„"
                                Style="{StaticResource Body1}"
                                TextColor="{StaticResource TextLightGray}" />
                            <Label 
                                Grid.Column="1"
                                Text="{Binding CircleOpacity, StringFormat='{0:P0}'}"
                                Style="{StaticResource Body1}"
                                TextColor="{StaticResource PrimaryCTA}" />
                        </Grid>
                        <Slider 
                            Value="{Binding CircleOpacity}"
                            Minimum="0"
                            Maximum="1"
                            MinimumTrackColor="{StaticResource PrimaryCTA}"
                            MaximumTrackColor="{StaticResource SurfaceDarkNavy}" />
                    </VerticalStackLayout>

                    <!-- Circle Border Width -->
                    <VerticalStackLayout Spacing="8">
                        <Grid ColumnDefinitions="*,Auto">
                            <Label 
                                Grid.Column="0"
                                Text="í…Œë‘ë¦¬ ë‘ê»˜"
                                Style="{StaticResource Body1}"
                                TextColor="{StaticResource TextLightGray}" />
                            <Label 
                                Grid.Column="1"
                                Text="{Binding CircleBorderWidth, StringFormat='{0}px'}"
                                Style="{StaticResource Body1}"
                                TextColor="{StaticResource PrimaryCTA}" />
                        </Grid>
                        <Slider 
                            Value="{Binding CircleBorderWidth}"
                            Minimum="1"
                            Maximum="5"
                            MinimumTrackColor="{StaticResource PrimaryCTA}"
                            MaximumTrackColor="{StaticResource SurfaceDarkNavy}" />
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Theme Settings -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="ðŸŒ™ í…Œë§ˆ"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    
                    <Grid ColumnDefinitions="*,Auto">
                        <Label 
                            Grid.Column="0"
                            Text="ë‹¤í¬ ëª¨ë“œ"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}"
                            VerticalOptions="Center" />
                        <Switch 
                            Grid.Column="1"
                            IsToggled="{Binding IsDarkMode}"
                            OnColor="{StaticResource PrimaryCTA}"
                            ThumbColor="{StaticResource TextWhite}" />
                    </Grid>

                    <Label 
                        Text="ðŸš§ ë¼ì´íŠ¸ ëª¨ë“œëŠ” ì¶”í›„ êµ¬í˜„ ì˜ˆì •ìž…ë‹ˆë‹¤."
                        Style="{StaticResource Caption}"
                        TextColor="{StaticResource TextLightGray}" />
                </VerticalStackLayout>
            </Frame>

            <!-- UI Size Settings -->
            <Frame BackgroundColor="{StaticResource SurfaceDarkGray}" Padding="20" CornerRadius="12">
                <VerticalStackLayout Spacing="15">
                    <Label 
                        Text="ðŸ“ UI í¬ê¸°"
                        Style="{StaticResource Heading3}"
                        TextColor="{StaticResource TextWhite}" />
                    
                    <!-- Font Size -->
                    <VerticalStackLayout Spacing="8">
                        <Label 
                            Text="í°íŠ¸ í¬ê¸°"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}" />
                        <HorizontalStackLayout Spacing="10">
                            <Button 
                                Text="Small"
                                Command="{Binding UpdateFontSizeCommand}"
                                CommandParameter="Small"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding FontSize}" Value="Small">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Medium"
                                Command="{Binding UpdateFontSizeCommand}"
                                CommandParameter="Medium"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding FontSize}" Value="Medium">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Large"
                                Command="{Binding UpdateFontSizeCommand}"
                                CommandParameter="Large"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding FontSize}" Value="Large">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>

                    <!-- Card Size -->
                    <VerticalStackLayout Spacing="8">
                        <Label 
                            Text="ì¹´ë“œ í¬ê¸°"
                            Style="{StaticResource Body1}"
                            TextColor="{StaticResource TextLightGray}" />
                        <HorizontalStackLayout Spacing="10">
                            <Button 
                                Text="Compact"
                                Command="{Binding UpdateCardSizeCommand}"
                                CommandParameter="Compact"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding CardSize}" Value="Compact">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Normal"
                                Command="{Binding UpdateCardSizeCommand}"
                                CommandParameter="Normal"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding CardSize}" Value="Normal">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                            <Button 
                                Text="Large"
                                Command="{Binding UpdateCardSizeCommand}"
                                CommandParameter="Large"
                                BackgroundColor="{StaticResource SurfaceDarkNavy}"
                                TextColor="{StaticResource TextWhite}"
                                Padding="15,8"
                                CornerRadius="6">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding CardSize}" Value="Large">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryCTA}" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,10,0,20">
                <Button 
                    Grid.Column="0"
                    Text="ì„¤ì • ì´ˆê¸°í™”"
                    Command="{Binding ResetSettingsCommand}"
                    BackgroundColor="{StaticResource SurfaceDarkNavy}"
                    TextColor="{StaticResource TextLightGray}"
                    CornerRadius="8"
                    Padding="15,12" />
                <Button 
                    Grid.Column="1"
                    Text="ì„¤ì • ì €ìž¥"
                    Command="{Binding SaveSettingsCommand}"
                    BackgroundColor="{StaticResource PrimaryCTA}"
                    TextColor="{StaticResource TextWhite}"
                    CornerRadius="8"
                    Padding="15,12" />
            </Grid>

            <!-- Loading Indicator -->
            <ActivityIndicator
                IsRunning="{Binding IsLoading}"
                IsVisible="{Binding IsLoading}"
                Color="{StaticResource PrimaryCTA}"
                WidthRequest="40"
                HeightRequest="40"
                HorizontalOptions="Center"
                Margin="20" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>

